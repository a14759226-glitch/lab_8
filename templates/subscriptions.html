{% extends "base.html" %}

{% block title %}Мои подписки - Currency Tracker{% endblock %}

{% block content %}
<div class="step-indicator">
    <div class="step completed">1</div>
    <div class="step completed">2</div>
    <div class="step active">3</div>
</div>

<h2>Мои подписки на валюты</h2>
<p>Здесь вы можете управлять своими подписками на курсы валют</p>

{% if message %}
<div class="alert alert-{{ message_type }}">{{ message }}</div>
{% endif %}

{% if user %}
<div class="user-info">
    <div class="form-group">
        <label>Пользователь:</label>
        <input type="text" value="{{ user.name }}" readonly>
    </div>

    <div class="form-group">
        <label>Email:</label>
        <input type="email" value="{{ user.email }}" readonly>
    </div>

    <div class="form-group">
        <label>Возраст:</label>
        <input type="number" value="{{ user.age }}" readonly>
    </div>
</div>
{% endif %}

{% if user_currencies %}
<h3>Отслеживаемые валюты:</h3>
<div class="currency-grid">
    {% for currency in user_currencies %}
    <div class="currency-card">
        <strong>{{ currency }}</strong>
        {% if currency in current_rates %}
        <div class="currency-rate">{{ "%.2f"|format(current_rates[currency]) }} ₽</div>
        {% else %}
        <div class="currency-rate">—</div>
        {% endif %}
        <form method="POST" action="/remove_subscription" style="margin-top: 10px;">
            <input type="hidden" name="currency" value="{{ currency }}">
            <button type="submit" class="btn-remove">Удалить</button>
        </form>
    </div>
    {% endfor %}
</div>

<div style="margin-top: 30px;">
    <a href="/currencies" class="btn">Добавить еще валюты</a>
</div>
{% else %}
<p>У вас пока нет подписок на валюты.</p>
<a href="/currencies" class="btn">Выбрать валюты для отслеживания</a>
{% endif %}
{% endblock %}